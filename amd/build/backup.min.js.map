{"version":3,"file":"backup.min.js","sources":["../src/backup.js"],"sourcesContent":["import Log from 'core/log';\n\nexport const restrictactivitybackup = (data) => {\n    Log.debug(\"hello\");\n    const biform = document.querySelector('#page-backup-backup div[role=\"main\"] form, #page-backup-import div[role=\"main\"] form');\n    const stage = biform.stage.value;\n    const jumpto = document.querySelector('[name=\"oneclickbackup\"]');\n    const legacy = document.querySelector('[name=\"setting_root_legacyfiles\"]');\n    // Remove \"Jump to final step\" button.\n    if (jumpto) {\n        jumpto.style.display = 'none';\n        jumpto.setAttribute('disabled', true);\n    }\n    // Make sure Legacy files are not imported.\n    if (legacy) {\n        legacy.removeAttribute(\"checked\");\n        legacy.setAttribute(\"disabled\", true);\n        legacy.value = 0;\n    }\n    if (stage != 2) {\n        return;\n    }\n    if (!data) {\n        return;\n    }\n\n    let checkboxes = biform.querySelectorAll('input[type=\"checkbox\"]');\n    Log.debug(data.length);\n    checkboxes.forEach(checkbox => {\n        let name = checkbox.name;\n        let label = checkbox.parentNode.innerText;\n        data.forEach((item) => {\n            if (item.activity && item.title) {\n                if ((name.search(new RegExp('activity_' + item.activity + '[0-9a-z_]+included')) != -1)\n                    && (label.search(item.title) != -1)) {\n                    checkbox.setAttribute(\"checked\", false);\n                    checkbox.setAttribute(\"disabled\", true);\n                }\n                return;\n            }\n            if (item.activity) {\n                if (name.search(new RegExp('activity_' + item.activity + '[0-9a-z_]+included')) != -1) {\n                    checkbox.setAttribute(\"checked\", false);\n                    checkbox.setAttribute(\"disabled\", true);\n                }\n                return;\n            }\n            if (item.title) {\n                if (label.search(item.title) != -1) {\n                    checkbox.setAttribute(\"checked\", false);\n                    checkbox.setAttribute(\"disabled\", true);\n                    // Let's also disable the user's info bit.\n                    // data.splice(key, 1); // Reduce the number of items to loop through as this one is done.\n                }\n                return;\n            }\n        });\n    });\n    Log.debug(data.length);\n};\n"],"names":["data","debug","biform","document","querySelector","stage","value","jumpto","legacy","style","display","setAttribute","removeAttribute","checkboxes","querySelectorAll","length","forEach","checkbox","name","label","parentNode","innerText","item","activity","title","search","RegExp"],"mappings":"sQAEuCA,oBAC/BC,MAAM,eACJC,OAASC,SAASC,cAAc,wFAChCC,MAAQH,OAAOG,MAAMC,MACrBC,OAASJ,SAASC,cAAc,2BAChCI,OAASL,SAASC,cAAc,wCAElCG,SACAA,OAAOE,MAAMC,QAAU,OACvBH,OAAOI,aAAa,YAAY,IAGhCH,SACAA,OAAOI,gBAAgB,WACvBJ,OAAOG,aAAa,YAAY,GAChCH,OAAOF,MAAQ,GAEN,GAATD,iBAGCL,gBAIDa,WAAaX,OAAOY,iBAAiB,uCACrCb,MAAMD,KAAKe,QACfF,WAAWG,SAAQC,eACXC,KAAOD,SAASC,KAChBC,MAAQF,SAASG,WAAWC,UAChCrB,KAAKgB,SAASM,OACNA,KAAKC,UAAYD,KAAKE,OAC+D,GAAhFN,KAAKO,OAAO,IAAIC,OAAO,YAAcJ,KAAKC,SAAW,yBACrB,GAA7BJ,MAAMM,OAAOH,KAAKE,SACtBP,SAASN,aAAa,WAAW,GACjCM,SAASN,aAAa,YAAY,IAItCW,KAAKC,UAC+E,GAAhFL,KAAKO,OAAO,IAAIC,OAAO,YAAcJ,KAAKC,SAAW,yBACrDN,SAASN,aAAa,WAAW,GACjCM,SAASN,aAAa,YAAY,IAItCW,KAAKE,QAC4B,GAA7BL,MAAMM,OAAOH,KAAKE,SAClBP,SAASN,aAAa,WAAW,GACjCM,SAASN,aAAa,YAAY,uBAQ9CV,MAAMD,KAAKe"}